<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Doctor Calendar - KMA Health</title>
    <link rel="stylesheet" th:href="@{/css/doctor-calendar.css}">
    <link rel="icon" type="image/x-icon" th:href="@{/images/icon/favicon.ico}">
</head>
<body>
<header th:replace="~{fragments/layout :: header-auth('DOCTOR')}"></header>

    <main class="calendar-container">
        <div class="calendar-header">
            <a th:href="@{/ui/profile/calendar(year=${currentMonth == 1 ? currentYear - 1 : currentYear}, month=${currentMonth == 1 ? 12 : currentMonth - 1})}" 
               class="nav-button">
                ← Попередній
            </a>
            
            <h2 class="month-year" th:text="${#strings.capitalize(#strings.toLowerCase(monthName))} + ' ' + ${currentYear}">
                Місяць Рік
            </h2>
            
            <a th:href="@{/ui/profile/calendar(year=${currentMonth == 12 ? currentYear + 1 : currentYear}, month=${currentMonth == 12 ? 1 : currentMonth + 1})}" 
               class="nav-button">
                Наступний →
            </a>
        </div>

        <!-- Calendar Grid -->
        <div class="calendar-grid">
            <!-- Day Headers -->
            <div class="day-header">Пн</div>
            <div class="day-header">Вт</div>
            <div class="day-header">Ср</div>
            <div class="day-header">Чт</div>
            <div class="day-header">Пт</div>
            <div class="day-header">Сб</div>
            <div class="day-header">Нд</div>

            <th:block th:each="i : ${#numbers.sequence(1, firstDayOfWeek - 1)}">
                <div class="calendar-day empty"></div>
            </th:block>
            <th:block th:each="day : ${#numbers.sequence(1, daysInMonth)}">
                <th:block th:with="currentDate=${firstDayOfMonth.plusDays(day - 1)}">
                    <div class="calendar-day" 
                         th:classappend="${currentDate.equals(T(java.time.LocalDate).now())} ? 'today' : ''">
                        <div class="day-number" th:text="${day}">1</div>
                        
                        <div class="appointments-list">
                            <a th:each="appointment : ${appointments}"
                               th:if="${appointment.date.equals(currentDate)}"
                               th:href="@{/ui/appointments/{id}(id=${appointment.id})}"
                               class="appointment-item" 
                               th:classappend="${appointment.status.toString()}">
                                <span class="appointment-time" th:text="${appointment.time}">10:00</span>
                                <span class="appointment-patient" th:text="${appointment.patientName}">Ім'я пацієнта</span>
                                <span class="appointment-status" 
                                      th:text="${#strings.capitalize(#strings.toLowerCase(appointment.status.toString()))}">
                                    Статус
                                </span>
                            </a>
                        </div>
                    </div>
                </th:block>
            </th:block>
        </div>

        <!-- Legend -->
        <div class="legend">
            <h3>Легенда:</h3>
            <div class="legend-items">
                <div class="legend-item">
                    <span class="status-badge SCHEDULED">●</span>
                    <span>Заплановано</span>
                </div>
                <div class="legend-item">
                    <span class="status-badge OPEN">●</span>
                    <span>Відкрито</span>
                </div>
                <div class="legend-item">
                    <span class="status-badge FINISHED">●</span>
                    <span>Завершено</span>
                </div>
            </div>
        </div>
    </main>

<footer th:replace="~{fragments/layout :: footer-auth('DOCTOR')}"></footer>

</body>
</html>
